cmake_minimum_required(VERSION 3.10)
project(Peyot)

set(CMAKE_CXX_STANDARD 17)
find_package (Threads)
find_package (OpenSSL REQUIRED)

set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -pthread(-D_REENTRANT, -lpthread)")

add_executable(PeyotServer server/main.cpp server/Server.cpp server/Server.h communication/Sender.cpp communication/Sender.h communication/Receiver.cpp communication/Receiver.h server/ConnectionHandler.cpp server/ConnectionHandler.h server/database/DBManager.cpp server/database/DBManager.h structures/User.cpp structures/User.h server/eventLog/ELManager.h server/eventLog/ELManager.cpp server/security/SecurityManager.cpp server/security/SecurityManager.h server/Executor.cpp server/Executor.h server/database/DBScheduleManager.cpp server/database/DBScheduleManager.h structures/Date.cpp structures/Date.h parser/Parser.cpp parser/Parser.h parser/LoginRequest.cpp parser/LoginRequest.h parser/RegisterRequest.cpp parser/RegisterRequest.h parser/Request.cpp parser/Request.h parser/RequestType.h parser/QuitRequest.cpp parser/QuitRequest.h parser/ModifyRequest.cpp parser/ModifyRequest.h parser/ResignRequest.cpp parser/ResignRequest.h parser/CheckMyTerminsRequest.cpp parser/CheckMyTerminsRequest.h parser/CheckTerminsByInstructorRequest.cpp parser/CheckTerminsByInstructorRequest.h parser/BookRequest.cpp parser/BookRequest.h parser/Response.cpp parser/Response.h server/LoggedUser.h parser/SetScheduleRequest.cpp parser/SetScheduleRequest.h parser/CheckInstructorsRequest.cpp parser/CheckInstructorsRequest.h)
add_executable(PeyotClient client/main.cpp client/Client.cpp client/Client.h communication/Sender.cpp communication/Sender.h communication/Receiver.cpp communication/Receiver.h client/UI/UI.cpp client/UI/UI.h parser/Parser.cpp parser/Parser.h parser/LoginRequest.cpp parser/LoginRequest.h parser/RegisterRequest.cpp parser/RegisterRequest.h parser/Request.cpp parser/Request.h parser/RequestType.h parser/QuitRequest.cpp parser/QuitRequest.h parser/ModifyRequest.cpp parser/ModifyRequest.h parser/ResignRequest.cpp parser/ResignRequest.h parser/CheckMyTerminsRequest.cpp parser/CheckMyTerminsRequest.h parser/CheckTerminsByInstructorRequest.cpp parser/CheckTerminsByInstructorRequest.h parser/BookRequest.cpp parser/BookRequest.h parser/Response.cpp parser/Response.h structures/Date.cpp structures/Date.h parser/SetScheduleRequest.cpp parser/SetScheduleRequest.h parser/CheckInstructorsRequest.cpp parser/CheckInstructorsRequest.h)
add_executable(tests libs/catch.hpp tests/SecurityTests.cpp server/security/SecurityManager.h server/security/SecurityManager.cpp tests/UsersDatabaseTests.cpp tests/ScheduleDatabaseTests.cpp server/database/DBManager.cpp server/database/DBManager.h structures/User.cpp structures/User.h server/database/DBScheduleManager.cpp server/database/DBScheduleManager.h structures/Date.cpp structures/Date.h tests/ParserTests.cpp parser/Request.h parser/Request.cpp parser/Parser.cpp parser/Parser.h parser/ModifyRequest.h parser/ModifyRequest.cpp)

target_link_libraries (PeyotServer ${CMAKE_THREAD_LIBS_INIT} )
target_link_libraries (PeyotServer OpenSSL::SSL)
target_link_libraries (tests OpenSSL::SSL)